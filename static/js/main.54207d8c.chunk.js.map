{"version":3,"sources":["parser/Rulebook.js","parser/Parser.js","components/TableOfContents.js","components/SelectedChapter.js","components/SearchBar.js","components/RulebookUI.js","components/Loading.js","App.js","reportWebVitals.js","index.js"],"names":["Tuple","chapterKey","ruleKey","this","Chapter","name","rules","Map","id","description","set","Rulebook","chapters","size","search","tuples","keys","get","entries","toLowerCase","includes","push","newTuples","tuple","chapterId","addRule","Token","text","Parser","rawData","rulebook","lines","trimToLines","line","token","tokenize","extractChapterId","isNaN","ruleId","extractRuleId","undefined","addChapter","firstLineString","terminatorString","index","indexOf","endOfRulesIndex","slice","trim","split","seperator","trimStart","substring","tokenId","parseInt","tokenParts","length","TableOfContents","props","Array","from","map","key","chapter","isSearched","searchedTuples","find","t","hasNoRules","className","onClick","e","onChapterClicked","SelectedChapter","title","SearchBar","type","placeholder","onChange","onSearchChange","target","value","RulebookUI","bind","state","selectedChapterKey","searchString","setState","includesSpecific","React","Component","Loading","message","App","parser","view","errorParsing","fetchRawData","fetch","corsProxy","then","response","ok","alert","json","data","handleRawData","contents","parse","isEmpty","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.54207d8c.chunk.js","sourcesContent":["\r\n\r\nclass Tuple {\r\n    constructor(chapterKey, ruleKey) {\r\n        this.chapterKey = chapterKey\r\n        this.ruleKey = ruleKey\r\n    }\r\n}\r\n\r\nclass Chapter {\r\n    constructor(name) {\r\n        this.name = name\r\n        this.rules = new Map()\r\n    }\r\n\r\n    addRule(id, description) {\r\n        this.rules.set(id, description)\r\n    }\r\n}\r\n\r\nclass Rulebook {\r\n\r\n    constructor() {\r\n        this.chapters = new Map()\r\n    }\r\n\r\n    isEmpty() {\r\n        return !this.chapters || this.chapters.size === 0\r\n    }\r\n\r\n    includes(search) {\r\n        let tuples = []\r\n\r\n        for(let chapterKey of this.chapters.keys()) {\r\n            for(let [ruleKey, ruleValue] of this.chapters.get(chapterKey).rules.entries()) {\r\n                if(ruleValue.toLowerCase().includes(search)) tuples.push(new Tuple(chapterKey, ruleKey))\r\n            }\r\n        }\r\n\r\n        return tuples\r\n    }\r\n\r\n    includesSpecific(search, tuples) {\r\n\r\n        let newTuples = []\r\n\r\n        for(let tuple of tuples) {\r\n            if(this.chapters.get(tuple.chapterKey).rules.get(tuple.ruleKey).toLowerCase().includes(search)) newTuples.push(tuple)\r\n        }\r\n\r\n        return newTuples\r\n    }\r\n\r\n    addChapter(id, name) {\r\n        this.chapters.set(id, new Chapter(name))\r\n    }\r\n\r\n    addRule(id, description, chapterId) {\r\n        this.chapters.get(chapterId).addRule(id, description)\r\n    }\r\n\r\n}\r\n\r\nexport default Rulebook","import Rulebook from './Rulebook.js';\r\n\r\n\r\nclass Token {\r\n    constructor(id, text) {\r\n        this.id = id\r\n        this.text = text\r\n    }\r\n}\r\n\r\nclass Parser {\r\n\r\n    parse(rawData) {\r\n\r\n        let rulebook = new Rulebook()\r\n        let lines = this.trimToLines(rawData)\r\n\r\n        for(const line of lines) {\r\n            let token = this.tokenize(line)\r\n            let chapterId = this.extractChapterId(token.id)\r\n\r\n            if(!isNaN(chapterId)) {\r\n                let ruleId = this.extractRuleId(token.id)\r\n                if(ruleId === undefined) rulebook.addChapter(chapterId, token.text)\r\n                else rulebook.addRule(ruleId, token.text, chapterId)\r\n            }\r\n        }\r\n        \r\n        return rulebook\r\n    }\r\n\r\n    trim(rawData, firstLineString, terminatorString) {\r\n\r\n        let index = rawData.indexOf(firstLineString)\r\n        let endOfRulesIndex = rawData.indexOf(terminatorString, index)\r\n        let trimmedData = rawData.slice(index, endOfRulesIndex)\r\n\r\n        return trimmedData\r\n    }\r\n\r\n    trimToLines(rawData) {\r\n        const trimmedData = this.trim(rawData, '1. Game Concepts\\r\\n\\r\\n', 'Glossary')\r\n        const seperator = /\\r?\\n/\r\n\r\n        let lines = trimmedData.split(seperator)\r\n        return lines\r\n    }\r\n\r\n    tokenize(line) {\r\n        line = line.trimStart()\r\n        const seperator = line.indexOf(' ')\r\n        let token = new Token(line.substring(0, seperator), line.substring(seperator))\r\n\r\n        return token\r\n    }\r\n\r\n    extractChapterId(tokenId) {\r\n        return parseInt(tokenId.substring(0, tokenId.indexOf('.')))\r\n    }\r\n\r\n    extractRuleId(tokenId) {\r\n        let tokenParts = tokenId.split('.')\r\n        return tokenParts.length > 1 && tokenParts[1] !== '' ? tokenParts[1] : undefined\r\n    }\r\n}\r\n\r\nexport default Parser","import React from 'react';\r\n\r\nfunction TableOfContents(props) {\r\n\r\n    const chapters = Array.from(props.rulebook.chapters.keys()).map((key) => {\r\n\r\n        const chapter = props.rulebook.chapters.get(key)\r\n        let isSearched = (props.searchedTuples.find(t => t.chapterKey === key)) ? true : false\r\n        let hasNoRules = (chapter.rules.size === 0) ? true : false\r\n\r\n        return (\r\n            <div key={key} className={`MenuItem ${hasNoRules ? 'Part' : 'Chapter'} ${isSearched ? 'Searched' : ''}`} onClick={(e) => props.onChapterClicked(key, e)}>\r\n                <span>{key}</span>\r\n                <span>{chapter.name}</span>\r\n            </div>\r\n        )\r\n    })  \r\n    \r\n    return (\r\n        <div className=\"TableOfContents\">\r\n            {chapters}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default TableOfContents","import React from 'react';\r\n\r\nfunction SelectedChapter(props) {\r\n\r\n    const chapter = props.rulebook.chapters.get(props.chapterKey)\r\n    const rules = Array.from(chapter.rules.keys()).map((key) => {\r\n\r\n        let isSearched = false\r\n        if(props.searchedTuples.find(tuple => tuple.ruleKey === key && tuple.chapterKey === props.chapterKey)) isSearched = true\r\n\r\n        return (\r\n            <div key={key} className={`MenuItem Rule ${isSearched ? 'Searched' : ''}`}>\r\n                <span>{key}</span>\r\n                <span>{chapter.rules.get(key)}</span>\r\n            </div>\r\n        )}\r\n    )  \r\n\r\n    const title = props.chapterKey + '. ' + chapter.name\r\n\r\n    return (\r\n        <div className=\"SelectedChapter\">\r\n            <h2 className='ChapterTitle'>{title}</h2>\r\n            {rules}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SelectedChapter","import React from 'react';\r\n\r\nfunction SearchBar(props) {\r\n    return (\r\n        <div className='SearchBar'>\r\n            <input\r\n                type=\"text\"\r\n                placeholder=\"Search for rules\"\r\n                onChange={(e) => props.onSearchChange(e.target.value.toLowerCase())}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SearchBar","import React from 'react';\r\nimport TableOfContents from './TableOfContents.js'\r\nimport SelectedChapter from './SelectedChapter.js'\r\nimport SearchBar from './SearchBar.js'\r\n\r\nclass RulebookUI extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.onChapterClicked = this.onChapterClicked.bind(this)\r\n    this.onSearchChange = this.onSearchChange.bind(this)\r\n    this.state = {\r\n      selectedChapterKey: 100,\r\n      searchString: '',\r\n      searchedTuples: []\r\n    }\r\n  }\r\n\r\n  onChapterClicked(key, e) { \r\n    this.setState({\r\n      selectedChapterKey: key\r\n    })\r\n  }\r\n\r\n  onSearchChange(search) {\r\n    let searchedTuples\r\n\r\n    if(!search) searchedTuples = []\r\n    else if(this.state.searchString && search.includes(this.state.searchString)) {\r\n      searchedTuples = this.props.rulebook.includesSpecific(search, this.state.searchedTuples)\r\n    }\r\n    else {\r\n      searchedTuples = this.props.rulebook.includes(search)\r\n    }\r\n\r\n    this.setState({searchString: search, searchedTuples: searchedTuples})\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className='Main'>\r\n        <div className='Header'>\r\n          <h1>MtG Rulebook</h1>\r\n          <SearchBar onSearchChange={this.onSearchChange}/>\r\n        </div>\r\n        <div className='Rulebook'>\r\n          <TableOfContents rulebook={this.props.rulebook} onChapterClicked={this.onChapterClicked} searchedTuples={this.state.searchedTuples}/>\r\n          <SelectedChapter rulebook={this.props.rulebook} chapterKey={this.state.selectedChapterKey} searchedTuples={this.state.searchedTuples}/>\r\n        </div>\r\n        <div className='Footer'>\r\n          <p>“MtG Rulebook is unofficial Fan Content permitted under the Fan Content Policy. Not approved/endorsed by Wizards. Portions of the materials used are property of Wizards of the Coast. ©Wizards of the Coast LLC.”</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default RulebookUI","import React from 'react';\r\n\r\nfunction Loading(props) {\r\n\r\n    return (\r\n        <div>\r\n            <h2>Loading...</h2>\r\n            <span>{props.message}</span>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Loading","import './App.css';\r\nimport React from 'react';\r\nimport Parser from './parser/Parser.js';\r\nimport RulebookUI from './components/RulebookUI.js';\r\nimport Loading from './components/Loading.js';\r\n\r\n\r\nclass App extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.parser = new Parser()\r\n\r\n    //this.handleRawData = this.handleRawData.bind(this)\r\n    this.state = {\r\n      view: 'paster',\r\n      rulebook: null,\r\n      errorParsing: false\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetchRawData()\r\n  }\r\n\r\n  fetchRawData() {\r\n    const corsProxy = 'https://api.allorigins.win/get?url='\r\n    const rulesUrl = 'https://media.wizards.com/2021/downloads/MagicCompRules%2020210419.txt'\r\n\r\n    fetch(corsProxy + rulesUrl)\r\n    .then(response => {\r\n      if(!response.ok) alert('There was a problem with fetching the data')\r\n      return response.json()\r\n    })\r\n    .then(data => this.handleRawData(data.contents))\r\n  }\r\n\r\n  handleRawData(rawData) {\r\n\r\n    const rulebook = this.parser.parse(rawData);\r\n    if(!rulebook.isEmpty()) {\r\n      this.setState({\r\n        rulebook: this.parser.parse(rawData),\r\n        view: 'rulebook'\r\n      });\r\n    }\r\n    else alert(\"There was a problem parsing the fetched data\")\r\n\r\n  }\r\n\r\n  render() {\r\n\r\n    let view\r\n    if(this.state.view === 'rulebook') view = <RulebookUI rulebook={this.state.rulebook}/>\r\n    else view = <Loading message='Fetching data'/>\r\n\r\n    return (\r\n      <div className=\"App\">\r\n        {view}\r\n      </div>\r\n    )}\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}